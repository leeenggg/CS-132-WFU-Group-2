<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      Unequal Streams: Analyzing Access to Quality Water in the Philippines
    </title>
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" href="img/logo.png" />
  </head>

  <body>
    <!-- NAVIGATION BAR -->
    <nav class="site-nav" aria-label="Primary Navigation">
      <ul>
        <li><a href="#overview">Overview</a></li>
        <li><a href="#data">Data</a></li>
        <li><a href="#eda">Methods</a></li>
        <li><a href="#results">Results</a></li>
        <li><a href="#about-us">Team</a></li>
      </ul>
    </nav>

    <!-- HERO SECTION  -->
    <section id="hero" class="hero">
      <img src="img/newbg2.jpg" class="hero-background-image" />
      <div class="intro" aria-hidden="false">
        <span class="typed" aria-live="polite"></span>
        <span class="cursor" aria-hidden="true">|</span>
      </div>

      <div class="title" aria-hidden="true">
        <h1>Unequal Streams:</h1>
        <h1>Unequal Streams:</h1>
        <h3>Analyzing Access to Quality Water in the Philippines</h3>
      </div>

      <p class="subtitle">
        This project aims to analyze the state of access to quality water in the
        Philippines, focusing on the various factors such as political,
        economic, and urban/rural population.
      </p>

      <br />

      <p class="subtitle">
        The project hopes to find conclusive results to pinpoint which factors
        continue to hinder and limit Filipinos from accessing quality water to
        improve water accessibility and management in the Philippines.
      </p>
    </section>

    <!-- OVERVIEW -->
    <section id="overview" class="overview-carousel content">
      <img src="img/1phvsworld.jpg" class="overview-bg-image" />
      <div class="overview-gradient-overlay"></div>

      <div class="carousel-container">
        <div class="carousel-track">
          <div id="overview-page-1" class="carousel-page active-page">
            <div class="big-letter-content">
              <h1>Background</h1>
              <p class="big-first-letter">
                PrimeWater, a water provider owned by Manuel Villar, has come
                into the limelight in April 2025, with citizens voicing their
                complaints about enduring substandard service for years,
                affecting upto 16 million Filipinos. These complaints were
                centralized in the Cavite and Bulacan areas which housing a mix
                of urban and rural communities. Some of the complaints and
                issues experienced included constant water interruptions, and
                continuous dirty tap water rendering it a health risk for those
                that use these in their day to day life. Given that population
                is on an increasing trend in the Philippines, it is a cause of
                concern if the Philippines may provide access to clean water for
                families around the country.
              </p>
              <br />
              <p>
                It is from this context that spurted the question – what is the
                current state of access to quality water in the Philippines, and
                what are the external factors affecting it? We wanted to find
                connections between political and economic factors, as well as
                the differences in urban and rural areas to see if they affect
                access to quality water in the country given the Philippines’
                rising population.
              </p>
              <div class="links">
                <a
                  href="https://www.abs-cbn.com/news/business/2025/5/9/primewater-issue-affects-16-million-consumers-palace-says-1756"
                  >PrimeWater issue affects 16 million consumers, Palace says |
                  ABS-CBN News</a
                >
                <br />
                <a
                  href="https://www.rappler.com/philippines/elections/cavite-polls-spotlight-residents-grievances-villar-primewater-2025/ "
                  >In Cavite, elections spotlight residents' longstanding woes
                  with Villars' PrimeWater</a
                >
              </div>
            </div>
          </div>

          <div id="overview-page-2" class="carousel-page">
            <div class="page-2-grid">
              <div class="page-2-panel">
                <h3>Problem</h3>
                <div class="panel-content">
                  <p>
                    Unequal access to quality water persists, especially between
                    urban and rural areas. Political, economic, and
                    environmental factors hinder sustainable water systems.
                  </p>
                </div>
              </div>

              <div class="page-2-panel">
                <h3>Research Questions</h3>
                <div class="panel-content">
                  <ol>
                    <li>
                      1. How does urbanization impact water quality in the
                      Philippines?
                    </li>
                    <li>
                      2. What are the disparities in water access between rural
                      and urban communities?
                    </li>
                  </ol>
                </div>
              </div>

              <div class="page-2-panel">
                <h3>Hypothesis</h3>
                <div class="panel-content">
                  <p>
                    <strong>Null:</strong> Urban development has no significant
                    effect on household access to quality water.
                  </p>
                  <p>
                    <strong>Alternative:</strong> Urban development
                    significantly affects household access to quality water.
                  </p>
                  <p>
                    <strong>Null:</strong>Geographic location (rural vs. urban) has no significant effect on household access to quality water.
                  </p>
                  <p>
                    <strong>Alternative:</strong> Geographic location (rural vs. urban) significantly affects household access to quality water.
                  </p>
                </div>
              </div>

              <div class="page-2-panel">
                <h3>Solution</h3>
                <div class="panel-content">
                  <p>
                    The project compares current conditions and global
                    strategies to identify practical, equitable approaches to
                    improve water quality, availability, and management.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <button class="carousel-arrow left" onclick="changeOverviewPage(-1)">
        &#10140;
      </button>
      <button class="carousel-arrow right" onclick="changeOverviewPage(1)">
        &#10140;
      </button>
      <div class="pagination-dots">
        <span class="dot active-dot" onclick="goToOverviewPage(0)"></span>
        <span class="dot" onclick="goToOverviewPage(1)"></span>
      </div>
    </section>

    <!-- DATA SECTION -->
    <section id="data" class="content">
      <div class="data-content">
        <div class="glass-panel main-data">
          <h2>Data Collection</h2>
          <p>
           In this section, we pull back the curtain on our critical process: <em>acquiring, cleaning, and preparing</em> the raw information that drives our key findings. Discover how we linked indicators like urbanization and economic growth to uncover the real story behind access to safely managed water in the Philippines.
          </p>
        </div>

        <button
          class="see-more"
          aria-expanded="false"
          aria-controls="expanded-panels"
        >
          See more
        </button>

        <div id="expanded-panels" class="expanded-panels" aria-hidden="true">
          <div class="expanded-row top">
            <div class="panel">
              <h3>Description</h3>
              <p>
                We utilized datasets covering water access, population
                demographics for urban and rural areas, and GDP. These were
                sourced from reputable bodies like Philippine Statistics
                Authority (PSA), UNICEF, International Monetary Fund (IMF),
                World Health Organization (WHO), and World Bank Group.
              </p>
            </div>

            <div class="panel">
              <h3>Size</h3>
              <p>
                The data covers regional data in the Philippines concerning
                around 18 regions, spanning over multiple years (generally
                ranging from 2010 to 2024).
              </p>
            </div>

            <div class="panel">
              <h3>Preprocessing</h3>
              <p>
                Data was cleaned to handle missing values, with names and values
                being generalized and standardized to one to allow proper
                processing and minimize error when conducting comparisons across
                regions of different sizes.
              </p>
            </div>
          </div>

          <div class="expanded-row bottom">
            <div class="panel gallery-panel">
              <h3>Collection</h3>
              <p>
                Data was gathered through desk research on government websites
                (PSA), international organization reports (UNICEF), and
                reputable academic databases (Kaggle).
              </p>

              <div class="dataset-gallery">
                <button class="scroll-btn left">&#10094;</button>

                <div class="dataset-track">
                  <a href="d1.html" target="_blank" class="dataset">
                    <img src="img/1phvsworld.jpg" alt="dataset 1" />
                    <h3>WASH Estimates</h3>
                  </a>

                  <a href="d2.html" target="_blank" class="dataset">
                    <img src="img/2dataset.png" alt="dataset 2" />
                    <h3>Household Access</h3>
                  </a>

                  <a href="d3.html" target="_blank" class="dataset">
                    <img src="img/dset3.jpg" alt="dataset 3" />
                    <h3>Urban Pop. %</h3>
                  </a>
                  <a href="d4.html" target="_blank" class="dataset">
                    <img src="img/2dataset.png" alt="dataset 4" />
                    <h3>Pop. Growth</h3>
                  </a>
                  <a href="d5.html" target="_blank" class="dataset">
                    <img src="img/2dataset.png" alt="dataset 5" />
                    <h3>Urban Level</h3>
                  </a>
                  <a href="d6.html" target="_blank" class="dataset">
                    <img src="img/2dataset.png" alt="dataset 6" />
                    <h3>Rural Pop.</h3>
                  </a>
                  <a href="d7.html" target="_blank" class="dataset">
                    <img src="img/dset7.png" alt="dataset 7" />
                    <h3>GDP (Country)</h3>
                  </a>
                  <a href="d8.html" target="_blank" class="dataset">
                    <img src="img/2dataset.png" alt="dataset 8" />
                    <h3>GRDP (Region)</h3>
                  </a>
                </div>

                <button class="scroll-btn right">&#10095;</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="video-container">
        <video src="img/vidbg.mp4" autoplay muted loop playsinline></video>
      </div>
    </section>

    <!-- EXPLORATORY DATA ANALYSIS SECTION -->
    <section id="eda" class="eda-browser-section">
      <h1 class="eda-browser-title">Methods</h1>

      <div class="eda-browser">
        <div class="eda-browser-tabs">
          <button
            class="eda-browser-tab active"
            onclick="openBrowserTab(event, 'eda1')"
          >
            RQ1
          </button>
          <button
            class="eda-browser-tab"
            onclick="openBrowserTab(event, 'eda2')"
          >
            RQ2
          </button>
          <button
            class="eda-browser-tab"
            onclick="openBrowserTab(event, 'eda4')"
          >
            Nutshell
          </button>
        </div>

        <div class="eda-browser-window">
          <div id="eda1" class="eda-browser-content active">
            <div class="eda-graph">
              <a href="#">
                <img src="img/R1.png" alt="" />
              </a>
            </div>
            <div class="eda-description">
              <h3>RQ1 Analysis</h3>
              <p>
                <strong>Plot Analysis</strong>
                <br />
                The scatter plot shows a clear positive relationship. The red
                regression line trends upwards, indicating that regions with a
                higher urbanization rate (further to the right) tend to have a
                higher percentage of "Safely Managed" water access (higher up).
                For example, we can see highly rural regions like MIMAROPA (28%
                urban) and Bicol Region (22% urban) in the bottom-left quadrant,
                with "Safely Managed" access rates around 25-30%. In contrast,
                highly urbanized regions like Central Luzon (56% urban) are in
                the top-right, with access rates above 60%.

                <br />
                <br />
                <strong>Hypothesis Test Analysis:</strong>
                <br />
                Pearson Correlation (r): 0.7039 This value indicates a strong
                positive linear correlation between urbanization and "Safely
                Managed" water access. <br />
                P-value: 0.0106 Since 0.0106 &lt; 0.05 (our significance level),
                the result is statistically significant.

                <br />
                <br />
                <strong>Conclusion:</strong> <br />
                We reject the null hypothesis. The data provides strong evidence
                that a region's urbanization rate has a significant positive
                effect on its level of "Safely Managed" water access. This plot
                and statistic directly answer the first research question.
              </p>
            </div>
          </div>

          <div id="eda2" class="eda-browser-content">
            <div class="eda-graph">
              <a href="#">
                <img src="img/R2.png" alt="" />
              </a>
            </div>
            <div class="eda-description">
              <h3>RQ2 Analysis</h3>
              <p>
                <strong>Plot Analysis</strong>
                <br />
                The scatter plot shows the relationship between a region's
                economic growth (GDP Growth %) and its "Safely Managed" water
                access. The red regression line is nearly flat, but slightly
                positive, suggesting a very weak upward trend. Visually, the
                points are scattered widely. For example, Central Luzon has a
                high GDP growth (5.6%) and high water access (67%), which
                supports the hypothesis. However, Central Visayas has an even
                higher GDP growth (6.2%) but lower water access (59%). This wide
                spread indicates that the relationship is not strong or clear.

                <br />
                <br />
                <strong>Hypothesis Test Analysis:</strong>
                <br />
                Pearson Correlation (r): 0.1983 This value indicates a very weak
                positive linear correlation. A value this close to 0 suggests
                that there is almost no linear relationship between the two
                variables. <br />
                P-value: 0.5376 This p-value is very high, and significantly
                greater than our 0.05 significance level.

                <br />
                <br />
                <strong>Conclusion:</strong> <br />
                We fail to reject the null hypothesis. The data shows no
                statistically significant linear correlation between a region's
                GDP growth rate and its "Safely Managed" water access. This
                directly answers the research question: based on the data,
                economic growth does not appear to be a significant factor in
                explaining the differences in quality water access across
                regions. This is a very important finding.
              </p>
            </div>
          </div>

          <div id="eda4" class="eda-browser-content">
            <div class="eda-graph">
              <a href="#">
                <img src="img/nutshell.png" alt="" />
              </a>
            </div>
            <div class="eda-description">
              <h3>Nutshell Analysis</h3>
              <p>
                <strong>Plot Analysis</strong>
                <br />
                X-Axis: The regions are sorted from most rural (like Bicol
                Region) on the left to most urban (like Central Luzon) on the
                right. <br />
                Y-Axis: Shows the 100% composition of water access for each
                region. As you move from left to right, you can visually see the
                dark blue bar (`Safely_Managed_2024`) grow larger, while the
                light blue bar (`Basic_2024`) shrinks.

                <br />
                <br />
                <strong>Conclusion:</strong> <br />
                This single plot demonstrates the project's key finding:
                urbanization is strongly linked to a shift from "Basic" water
                access to "Safely Managed" water access. This answers both the
                research questions in one clear, compelling visual.
              </p>
            </div>
          </div>
        </div>
      </div>

      <div class="eda-btn-container">
        <a href="https://colab.research.google.com/drive/1FqpxW-Km4PgwXoPgCLs4uItzXSJspfmC?usp=drive_link" class="view-analysis-btn" target="_blank">
          View Full Data Analysis
        </a>
      </div>
    </section>

    <section id="results">
      <div class="results-content">
        <h2>Results & Discussion</h2>

        <div class="results-grid">
          <div class="result-card" onclick="toggleResult(this)">
            <h3>Discussion</h3>
            <div class="content-peek-wrapper">
              <p>
                Our Exploratory Data Analysis reveals that the primary driver of
                water quality in the Philippines is structural rather than
                purely economic. A strong, statistically significant correlation
                between urbanization rates and "safely managed" water access
                indicates that population density is currently a prerequisite
                for viable, high-quality infrastructure. This suggests that the
                country's utility model relies heavily on the economies of scale
                found in dense urban centers like NCR, effectively leaving rural
                provinces to rely on "basic" sources due to the logistical and
                financial difficulties of extending piped networks to dispersed
                populations. Crucially, our results challenge the assumption
                that rapid regional economic growth automatically translates to
                better public amenities. The lack of a significant link between
                recent GDP growth and water quality highlights a "development
                lag", where economic gains in developing regions have not yet
                flowed into public sanitation infrastructure.
              </p>
            </div>
            <p class="more-info">&lt;click for more&gt;</p>
          </div>

          <div class="result-card" onclick="toggleResult(this)">
            <h3>Implications</h3>
            <div class="content-peek-wrapper">
              <p>
                This data exposes a stark divide in quality rather than
                quantity. While the Philippines has largely achieved universal
                access to "improved" water sources, a deep inequality persists
                in water safety. Rural families are forced to shoulder the
                hidden health tax of treating their own water or risking
                waterborne diseases, which can trap provinces in poverty despite
                national economic gains. Furthermore, the strong link between
                urbanization and quality services reinforces the pull factor of
                major cities, exacerbating urban overcrowding and informal
                settlements. Ultimately, the data implies that relying solely on
                market-driven economic growth to close the water gap is
                ineffective, targeted state interventions and subsidies are
                necessary to build "safely managed" systems in lower-density
                areas where they are not commercially immediate.
              </p>
            </div>
            <p class="more-info">&lt;click for more&gt;</p>
          </div>

          <div class="result-card" onclick="toggleResult(this)">
            <h3>Limitations</h3>
            <div class="content-peek-wrapper">
              <p>
                A major limitation of the study was the data available on
                specific areas of water quality in the Philippines. As such, we
                were only able to collect from a singular source (WHO/UNICEF
                JMP), which aggregated data per region, resulting in the
                analysis being limited to per region and not in specific areas
                of a region where water quality may vary. Thus, results on data
                analysis are only relevant to the regional level and cannot be
                generalized to per city or even household level for Filipinos.
                Additionally, data on rural and urban areas and population were
                either very limited or not available, with the most recent
                available urban/rural population data being 2020 collected from
                PSA, having to result to extrapolating and estimating rural and
                urban population data in order to analyze for the year 2025.
                Analysis was also limited to economic factors, namely GDP, as
                political factors were difficult to quantify and collate to
                provide meaningful analysis results correlating to water
                quality. This resulted in research question 2 being partially
                answered, as political factors were not taken into account in
                assessing its correlation to water quality.
              </p>
            </div>
            <p class="more-info">&lt;click for more&gt;</p>
          </div>

          <div class="result-card" onclick="toggleResult(this)">
            <h3>Conclusion</h3>
            <div class="content-peek-wrapper">
              <p>
                Overall, the study shows that urbanization, and not economic
                growth, is the main factor affecting water quality in the
                Philippines. Urban regions have more access to safely managed
                water because dense populations make investments on piped
                systems financially viable, while rural areas remain dependent
                on basic sources due to the high cost of extending
                infrastructure. This creates a clear quality gap between the two
                areas, with rural families facing greater health risks and
                higher personal costs. The lack of correlation between GDP and
                water quality further suggests that economic gains are not being
                matched by improvements in water access, especially in rural
                communities.
              </p> <br>
              <p>
                Because of this, the study highlights the ongoing divide in
                access to high-quality water and the need for stronger support
                for rural areas. Filipinos can use the findings to identify
                which families and regions have better or worse access to clean
                water, using population and water access data as key indicators.
                Thus, this study may be used as an added research metric to
                further strengthen policies that may be created to give all
                Filipino families, may it be in urban or rural areas, equal
                access to clean, safe, and quality water.
              </p>
            </div>
            <p class="more-info">&lt;click for more&gt;</p>
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT US SECTION -->
    <section id="about-us">
      <div class="about-container">
        <h1>About Us</h1>
        <p class="about-subtitle">Meet the team behind this project.</p>

        <div class="team-grid">
          <div class="team-member">
            <img src="img/berna.JPG" alt="Member 1" />
            <h3>Bernadette Tan Bernardino</h3>
            <h2>Data Analyst</h2>
            <p class="contact">
              <a href="mailto: btbernardino@up.edu.ph">btbernardino@up.edu.ph</a
              ><br />
            </p>
            <p class="description">
              As a 3rd-year Computer Science student, I am a diligent and
              motivated learner with a strong work ethic. I am adept at the
              troubleshooting and debugging process, and I am committed to
              seeing projects through from conception to completion. I am always
              eager to learn and apply new technologies to solve real-world
              problems. After a focused day of work, I enjoy unwinding at home
              with interests like video games and television series.
            </p>
          </div>

          <div class="team-member">
            <img src="img/kylian.jpg" alt="Member 2" />
            <h3>Kylian Buton</h3>
            <h2>Data Analyst</h2>
            <p class="contact">
              <a href="mailto: cbuton@up.edu.ph">cbuton@up.edu.ph</a><br />
            </p>
            <p class="description">
              Hello! I’m a Transgender Computer Science Student who loves
              getting her work done efficiently, no shortcuts and no
              round-abouts, to get my work done fast and perfect gives me the
              most satisfaction. In terms of passion, I plan to be either a
              cybersecurity analyst or a web development programmer, both pique
              my interest and I would love to take on either as a future job
              after graduation.
            </p>
          </div>

          <div class="team-member">
            <img src="img/coleen.png" alt="Member 3" />
            <h3>Coleen Gatus</h3>
            <h2>Web Designer</h2>
            <p class="contact">
              <a href="mailto: csgatus@up.edu.ph">csgatus@up.edu.ph</a><br />
            </p>
            <p class="description">
              Driven by curiosity and a strong sense of purpose, I’m a 3rd-year
              Computer Science student who thrives on solving complex problems.
              I see every project as an opportunity to push my limits, explore
              new perspectives, and grow through persistence and hard work.
              Beyond academics, I find balance and inspiration through my
              hobbies — dancing, playing the ukulele, listening to music, and
              staying active. 
            </p>
          </div>

          <div class="team-member">
            <img src="img/russ.jpg" alt="Member 4" />
            <h3>Russell Lawrence N. Sison</h3>
            <h2>Data Analyst</h2>
            <p class="contact">
              <a href="mailto: rnsison@up.edu.ph">rnsison@up.edu.ph</a><br />
            </p>
            <p class="description">
              Hello world! I’m a 3rd year Computer Science student with an eager
              interest to learn game development and the like. Adaptable and
              quick-witted, I am flexible in learning new technologies to
              innovate, develop, and create ideas. While not in work mode, I
              destress with hobbies such as playing video games and dancing.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- JAVASCRIPT -->
    <script>
      function openBrowserTab(evt, tabId) {
        const tabs = document.querySelectorAll(".eda-browser-tab");
        const contents = document.querySelectorAll(".eda-browser-content");
        tabs.forEach((tab) => tab.classList.remove("active"));
        contents.forEach((content) => content.classList.remove("active"));
        evt.currentTarget.classList.add("active");
        document.getElementById(tabId).classList.add("active");
      }

      function toggleResult(clickedCard) {
        if (clickedCard.classList.contains("expanded")) {
          clickedCard.classList.remove("expanded");
          return;
        }
        document.querySelectorAll(".result-card").forEach((card) => {
          card.classList.remove("expanded");
        });
        clickedCard.classList.add("expanded");
      }

      document.addEventListener("DOMContentLoaded", () => {
        const message = "Hi! We are Group 2 and this is our project,";
        const typedEl = document.querySelector(".typed");
        const cursor = document.querySelector(".cursor");
        const hero = document.querySelector(".hero");
        const title = document.querySelector(".title");
        let i = 0;

        function typeChar() {
          if (!typedEl) return;
          if (i < message.length) {
            typedEl.textContent += message.charAt(i);
            i++;
            setTimeout(typeChar, 60);
          } else {
            if (hero) hero.classList.add("typing-done");
            if (title) title.setAttribute("aria-hidden", "false");
            setTimeout(() => {
              if (cursor) cursor.style.opacity = "0";
            }, 300);
          }
        }
        setTimeout(typeChar, 250);

        const sections = document.querySelectorAll("section");
        const navLinks = document.querySelectorAll(".site-nav ul li a");

        window.addEventListener("scroll", () => {
          let current = "";
          sections.forEach((section) => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.clientHeight;
            if (window.scrollY >= sectionTop - sectionHeight / 3) {
              current = section.getAttribute("id");
            }
          });

          navLinks.forEach((a) => {
            a.classList.remove("active");
            if (a.getAttribute("href").includes(current)) {
              a.classList.add("active");
            }
          });
        });

        // 3. UNIVERSAL SCROLL GLIDE
        const sectionIds = [
          "hero",
          "overview",
          "data",
          "eda",
          "results",
          "about-us",
        ];
        let skippedState = {};
        sectionIds.forEach((id) => (skippedState[id] = false));

        const nav = document.querySelector(".site-nav");

        window.addEventListener(
          "scroll",
          () => {
            const y = window.scrollY;

            // Parallax
            if (hero) hero.classList.toggle("scrolled", y > 30);
            if (nav) nav.classList.toggle("scrolled", y > 20);
            if (title)
              title.style.transform = `translateY(${Math.min(-y * 0.3, 0)}px)`;

            for (let j = 0; j < sectionIds.length - 1; j++) {
              const currentId = sectionIds[j];
              const nextId = sectionIds[j + 1];

              const currentEl = document.getElementById(currentId);
              const nextEl = document.getElementById(nextId);

              if (currentEl && nextEl) {
                const currentTop = currentEl.offsetTop;
                const currentHeight = currentEl.offsetHeight;

                if (y >= currentTop && y < currentTop + currentHeight) {
                  const progress = (y - currentTop) / currentHeight;

                  let threshold = 0.4;

                  if (currentEl.classList.contains("expanded")) {
                    threshold = 0.95;
                  }
                  // const gallery = currentEl.querySelector(".dataset-gallery");
                  // if (gallery && gallery.matches(":hover")) {
                  //   threshold = 1.1; // Effectively disable glide
                  // }
                  if (
                    progress > threshold &&
                    progress < 0.99 &&
                    !skippedState[currentId]
                  ) {
                    nextEl.scrollIntoView({ behavior: "smooth" });
                    skippedState[currentId] = true;
                  }
                }
                // Reset state if we scroll back up
                else if (y < currentTop) {
                  skippedState[currentId] = false;
                }
              }
            }
          },
          { passive: true }
        );

        const revealObserver = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                document.body.classList.add(`near-${entry.target.id}`);
              } else {
                document.body.classList.remove(`near-${entry.target.id}`);
              }
            });
          },
          { threshold: 0.15 }
        );

        sectionIds.forEach((id) => {
          const el = document.getElementById(id);
          if (el) revealObserver.observe(el);
        });

        const track = document.querySelector("#overview .carousel-track");
        const dots = document.querySelectorAll(
          "#overview .pagination-dots .dot"
        );

        if (track && track.children.length > 0) {
          let slides = Array.from(track.children);
          const firstClone = slides[0].cloneNode(true);
          const lastClone = slides[slides.length - 1].cloneNode(true);

          firstClone.id = "clone-first";
          lastClone.id = "clone-last";

          track.appendChild(firstClone);
          track.insertBefore(lastClone, slides[0]);

          const allSlides = document.querySelectorAll(".carousel-page");
          let counter = 1;
          const size = 100;

          track.style.transform = `translateX(${-size * counter}%)`;
          updateDots(1);

          function updateDots(index) {
            dots.forEach((dot) => dot.classList.remove("active-dot"));
            let realIndex = 0;
            if (index === 1 || index === 3) realIndex = 0;
            if (index === 2 || index === 0) realIndex = 1;
            if (dots[realIndex]) dots[realIndex].classList.add("active-dot");
          }

          window.changeOverviewPage = function (direction) {
            if (counter >= allSlides.length - 1 && direction === 1) return;
            if (counter <= 0 && direction === -1) return;
            track.style.transition = "transform 0.5s ease-in-out";
            counter += direction;
            track.style.transform = `translateX(${-size * counter}%)`;
            updateDots(counter);
          };

          window.goToOverviewPage = function (index) {
            track.style.transition = "transform 0.5s ease-in-out";
            counter = index + 1;
            track.style.transform = `translateX(${-size * counter}%)`;
            updateDots(counter);
          };

          track.addEventListener("transitionend", () => {
            if (allSlides[counter].id === "clone-first") {
              track.style.transition = "none";
              counter = 1;
              track.style.transform = `translateX(${-size * counter}%)`;
            }
            if (allSlides[counter].id === "clone-last") {
              track.style.transition = "none";
              counter = allSlides.length - 2;
              track.style.transform = `translateX(${-size * counter}%)`;
            }
          });
        }

        const seeMore = document.querySelector(".see-more");
        const dataContent = document.querySelector(".data-content");
        const expandedPanels = document.getElementById("expanded-panels");
        const dataSection = document.getElementById("data");

        if (seeMore && dataContent && dataSection) {
          seeMore.addEventListener("click", function () {
            const isExpanded = dataContent.classList.toggle("expanded");
            seeMore.setAttribute(
              "aria-expanded",
              isExpanded ? "true" : "false"
            );
            expandedPanels.setAttribute(
              "aria-hidden",
              isExpanded ? "false" : "true"
            );
            seeMore.textContent = isExpanded ? "See less" : "See more";
            dataSection.classList.toggle("expanded", isExpanded);

            if (isExpanded) {
              dataContent.scrollIntoView({
                behavior: "smooth",
                block: "center",
              });
            }
          });
        }

        const galleryTrack = document.querySelector(".dataset-track");
        if (galleryTrack) {
          Array.from(galleryTrack.children).forEach((dataset) => {
            galleryTrack.appendChild(dataset.cloneNode(true));
          });

          let scrollPos = 0;
          let isPaused = false;
          const leftBtn = document.querySelector(".scroll-btn.left");
          const rightBtn = document.querySelector(".scroll-btn.right");
          const datasetWidth =
            (galleryTrack.children[0].offsetWidth || 300) + 20;

          function autoScroll() {
            if (!isPaused) {
              scrollPos += 0.5;
              if (scrollPos >= galleryTrack.scrollWidth / 2) {
                scrollPos = 0;
              }
              galleryTrack.style.transform = `translateX(-${scrollPos}px)`;
            }
            requestAnimationFrame(autoScroll);
          }
          requestAnimationFrame(autoScroll);

          if (leftBtn && rightBtn) {
            [galleryTrack, leftBtn, rightBtn].forEach((el) => {
              el.addEventListener("mouseenter", () => (isPaused = true));
              el.addEventListener("mouseleave", () => (isPaused = false));
            });
            rightBtn.addEventListener("click", () => {
              scrollPos += datasetWidth;
              if (scrollPos >= galleryTrack.scrollWidth / 2) scrollPos = 0;
              galleryTrack.style.transform = `translateX(-${scrollPos}px)`;
            });
            leftBtn.addEventListener("click", () => {
              scrollPos -= datasetWidth;
              if (scrollPos < 0)
                scrollPos = galleryTrack.scrollWidth / 2 - datasetWidth;
              galleryTrack.style.transform = `translateX(-${scrollPos}px)`;
            });
          }
        }
      });
    </script>
  </body>
</html>
